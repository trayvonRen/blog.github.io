## MVC

**MVC 模式**（Model–view–controller）是软件工程中的一种软件架构模式，把软件系统分为三个基本部分：模型（Model）、视图（View）和控制器（Controller）。

- **模型（Model）**   管理应用的行为和数据，响应数据请求（经常来自视图）和更新状态的指令（经常来自控制器）。
- **视图（View）** 管理作为位图展示到屏幕上的图形和文字输出。
- **控制器（Controller）** 翻译用户的输入并依照用户的输入操作模型和视图。

### 依赖关系

三者之间的依赖关系非常明确：在 MVC 中，模型层可以单独工作，而视图层和控制器层都依赖模型层中的数据。

![](/img/design/mvcdep.jpeg)

### 占主导地位的控制器

MVC 架构模式的三个组成部分：Model、View 和 Controller 中最重要的就是控制器，它承担了整个架构中的大部分业务逻辑，同时在用户请求到达或者事件发生时都会首先通知控制器并由它来决定如何响应这次请求或者事件。  
在 MVC 中，所有的用户请求都会首先交给控制器，再由控制器来决定如何响应用户的输入，无论是更新模型中的信息还是渲染相应的视图，都是通过控制器来决定的；也就是说，在 MVC 中，控制器占据主导地位，它决定用户的输入是如何被处理的。

## 后端 MVC 架构

以 SpringMvc 为例

![](/img/design/springmvc.png)

- **controller**  
  controller 层负责具体的业务模块流程的控制，在此层要调用 service 层的接口来控制业务流程，控制的配置也同样是在 Spring 的配置文件里进行，针对具体的业务流程，会有不同的控制器。我们具体的设计过程可以将流程进行抽象归纳，设计出可以重复利用的子单元流程模块。这样不仅使程序结构变得清晰，也大大减少了代码量。
- **service**  
  service 层主要负责业务模块的应用逻辑应用设计。同样是首先设计接口，再设计其实现类，接着再 Spring 的配置文件中配置其实现的关联。这样我们就可以在应用中调用 service 接口来进行业务处理。service 层的业务实，具体要调用已经定义的 dao 层接口，封装 service 层业务逻辑有利于通用的业务逻辑的独立性和重复利用性。程序显得非常简洁。
- **dao**  
  dao 层主要做数据持久层的工作，负责与数据库进行联络的一些任务都封装在此，dao 层的设计首先是设计 dao 层的接口，然后在 Spring 的配置文件中定义此接口的实现类，然后就可以再模块中调用此接口来进行数据业务的处理，而不用关心此接口的具体实现类是哪个类，显得结构非常清晰，dao 层的数据源配置，以及有关数据库连接参数都在 Spring 配置文件中进行配置。

## 现代 C/S 架构：MVC + MVC

目前的大多数应用程序都非常复杂并且同时包含客户端和服务端，两者分开部署但同时又都遵循 MVC 或者衍生的架构模式；过去的 Web 应用由于并不复杂，前端和服务端往往都部署在同一台服务器上，比如说使用 erb 模板引擎的 Rails 或者使用 jsp 的 Java 等等；这时的 Web 应用都遵循 MVC 架构模式：

![](/img/design/oldmvc.jpeg)

过去的 Web 应用的非常简单，而现在的应用程序都非常复杂，而整个应用程序无论是 Web 还是客户端其实都包含两个部分，也就是前端/客户端和后端；先抛开后端不谈，无论是 Web 前端、iOS 还是 Android 都遵循 MVC 架构模式或者它的变种。

![](/img/design/diffmvc.jpeg)

在实际情况下，单独的 iOS、Android 和 Web 应用往往不能单独工作，这些客户端应用需要与服务端一起工作；当前端/客户端与后端一同工作时，其实分别『部署』了两个不同的应用，这两个应用都遵循 MVC 架构模式：

![](/img/design/newmvc.jpeg)

客户端和服务器通过网络进行连接，并组成了一个更大的 MVC 架构；从这个角度来看，服务端的模型层才存储了真正的数据，而客户端的模型层只不过是一个存储在客户端设备中的本地缓存和临时数据的集合；同理，服务端的视图层也不是整个应用的视图层，用于为用户展示数据的视图层位于客户端，也就是整个架构的最顶部；中间的五个部分，也就是从低端的模型层到最上面的视图共同组成了整个应用的控制器，将模型中的数据以合理的方式传递给最上层的视图层用于展示。

## 参考资料

[浅谈 MVC、MVP 和 MVVM 架构模式](https://draveness.me/mvx/)  
[SpringMVC 的层：DAO、Service、Controller、View 的关系](https://www.huaweicloud.com/articles/a2d52ff0783534b3f6e36c2cb184b50e.html)
