域名系统（英语：Domain Name System，缩写：DNS）是互联网的一项服务。它作为将域名和 IP 地址相互映射的一个分布式数据库，能够使人更方便地访问互联网。DNS 使用 TCP 和 UDP 端口 53。当前，对于每一级域名长度的限制是 63 个字符，域名总长度则不能超过 253 个字符。

DNS 系统中，常见的资源记录类型有：

- 主机记录（A 记录）：RFC 1035 定义，A 记录是用于名称解析的重要记录，它将特定的主机名映射到对应主机的 IP 地址上。
- 别名记录（CNAME 记录）: RFC 1035 定义，CNAME 记录用于将某个别名指向到某个 A 记录上，这样就不需要再为某个新名字另外创建一条新的 A 记录。
- IPv6 主机记录（AAAA 记录）: RFC 3596 定义，与 A 记录对应，用于将特定的主机名映射到一个主机的 IPv6 地址。
- 服务位置记录（SRV 记录）: RFC 2782 定义，用于定义提供特定服务的服务器的位置，如主机（hostname），端口（port number）等。
- 域名服务器记录（NS 记录） ：用来指定该域名由哪个 DNS 服务器来进行解析。 您注册域名时，总有默认的 DNS 服务器，每个注册的域名都是由一个 DNS 域名服务器来进行解析的，DNS 服务器 NS 记录地址一般以以下的形式出现： ns1.domain.com、ns2.domain.com 等。 简单的说，NS 记录是指定由哪个 DNS 服务器解析你的域名。
  NAPTR 记录：RFC 3403 定义，它提供了正则表达式方式去映射一个域名。NAPTR 记录非常著名的一个应用是用于 ENUM 查询。

## DNS 查询过程

![](/img/other/dns.png)

- 第一步：客户机提出域名解析请求,并将该请求发送给本地 域名服务器。
- 第二步：当本地 域名服务器收到请求后,就先查询本地 缓存,如果 该纪录项,则本地 域名服务器就直接把查询 结果返回。
  :::warning
  本地区域名服务器通常性能都会很好，它们一般都会缓存域名解析结果，当然缓存时间是受域名的失效时间控制的，一般缓存空间不是影响域名失效的主要因素。大约 90%的域名解析都到这里就已经完成了，所以 LDNS 主要承担了域名的解析工作。
  :::
- 第三步：如果本地 缓存中没 该纪录,则本地域名服务器就直接把请求发给根域名服务器,然后根域名服务器再返回给本地域名服务器一个所查询域(根 子域) 主域名服务器 地址。
- 第四步：本地服务器再向 一步返回 域名服务器发送请求,然后接受请求 服务器查询自己 缓存,如果没 该纪录,则返回相关 下级 域名服务器 地址。
- 第五步：重复第四步,直到找到正确 纪录。
- 第六步：本地域名服务器把返回 结果保存到缓存,以备下一次使用,同时还将结果返回给客户机。

## DNS 缓存

- host 文件
- 浏览器 dns 缓存
- 操作系统的 dns 缓存
- 每一级的域名服务器缓存

## 域名解析优化

### 预解析

```html
<link rel="dns-prefetch" href="http://bdimg.share.baidu.com" />
```

### 智能缓存

### 优化 dns 服务器

自己做 DNS 解析服务器，域名的解析服务器修改为自己的 DNS，解析速度就可以自己决定。
